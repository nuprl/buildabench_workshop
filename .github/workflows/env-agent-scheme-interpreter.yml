name: env-agent-scheme-interpreter

on:
  push:
    paths:
      - ".github/workflows/env-agent-scheme-interpreter.yml"
      - "test_projects/scheme_interpreter/**"
      - "src/buildabench_workshop/**"
  pull_request:
    paths:
      - ".github/workflows/env-agent-scheme-interpreter.yml"
      - "test_projects/scheme_interpreter/**"
      - "src/buildabench_workshop/**"
  workflow_dispatch:

jobs:
  env-agent:
    runs-on: self-hosted
    env:
      OPENAI_MODEL: openai/claude-haiku-4-5
    steps:
      - name: Check out repository
        uses: actions/checkout@v4

      - name: Run env_agent for scheme_interpreter
        run: |
          uv run python3 -m buildabench_workshop.env_agent \
            --repo test_projects/scheme_interpreter \
            --tips-path test_projects/scheme_interpreter/env_agent_tips.txt \
            --agent codex \
            --container "env_agent__scheme_interpreter_${{ github.run_id }}"
